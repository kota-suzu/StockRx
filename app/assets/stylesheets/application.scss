/* ========================================== */
/* StockRx メインスタイルシート */
/* ========================================== */
/* CLAUDE.md準拠: 統一デザインシステムによる重複解消とメンテナンス性向上 */
/* メタ認知: ファイル構造の階層化により、開発効率とコード品質を向上 */
/* 横展開: 全セクション（管理者・店舗・公開）で一貫したスタイル体験 */
/* ========================================== */

// ========================================
// 統一デザインシステムのコア要素
// ========================================

@import "variables";      // 統一カラーシステム・デザイントークン
@import "mixins";         // 共通ミックスイン・ユーティリティ関数

// ========================================
// Bootstrap 5設定とインポート
// ========================================

// Bootstrap変数のオーバーライド（統一カラーを適用）
$primary: $brand-primary;
$secondary: $brand-secondary;
$success: #28a745;
$danger: #dc3545;
$warning: #ffc107;
$info: #17a2b8;
$light: #f8f9fa;
$dark: #343a40;

// Bootstrap本体をインポート
@import "bootstrap";

// ========================================
// 統合コンポーネントスタイル
// ========================================

@import "components/cards";          // カードコンポーネント統合
@import "components/buttons";        // ボタンコンポーネント統合
@import "components/modern_cards";   // モダンカードコンポーネント（WCAG AA準拠）

// ========================================
// レガシーコンポーネント（段階的移行対象）
// ========================================

@import "store_selection";       // 店舗選択専用スタイル（移行対象）
@import "bootstrap_enhancements"; // Bootstrap拡張（統合後削除予定）

// ========================================
// モダンUIシステム（2024年最新）
// ========================================
@import "store_modern";          // 店舗画面用モダンUIシステム

// ========================================
// ベーススタイル（グローバル適用）
// ========================================

body {
  font-family: 'Helvetica Neue', Arial, sans-serif;
  background-color: var(--bg-page);  // 階層システム: ページレベル背景
  color: var(--text-primary);
  line-height: 1.6;
}

// メインコンテンツエリアのセクション背景
.container,
.container-fluid {
  &.content-section {
    background-color: var(--bg-section);
    padding: var(--spacing-4);
    border-radius: var(--radius-lg);
    margin-bottom: var(--spacing-4);
  }
}

// ベースレイアウトの統一
.min-vh-100 {
  min-height: 100vh;
}

// フレックスレイアウトの基本設定
.d-flex.flex-column.min-vh-100 {
  min-height: 100vh;
}

// ========================================
// 統一フォームスタイル
// ========================================

.form-control,
.form-select {
  @include form-control-base();
}

.form-group,
.mb-3 {
  @include form-group-spacing();
}

// ========================================
// 統一アラート・メッセージスタイル
// ========================================

.alert {
  @include alert-base();
  
  &.alert-success {
    @include alert-variant(#d1edff, #0c5460, var(--bs-success));
  }
  
  &.alert-danger {
    @include alert-variant(#f8d7da, #721c24, var(--bs-danger));
  }
  
  &.alert-warning {
    @include alert-variant(#fff3cd, #856404, var(--bs-warning));
  }
  
  &.alert-info {
    @include alert-variant(#d1ecf1, #0c5460, var(--bs-info));
  }
}

// ========================================
// 統一テーブルスタイル
// ========================================

.table {
  @include table-modern();
  
  // テーブルヘッダーの強化
  thead {
    th {
      background-color: #ffffff;  // 純白に変更（より明るく）
      border-bottom: 2px solid var(--border-primary);
      font-weight: 600;
      color: var(--text-primary);
    }
  }
  
  // 縞模様パターン
  tbody {
    tr {
      border-bottom: 1px solid var(--border-light);
      
      // 奇数行に背景色
      &:nth-child(odd) {
        background-color: rgba(248, 250, 252, 0.3);  // より薄く
      }
      
      // ホバー効果
      &:hover {
        background-color: rgba(241, 245, 249, 0.5);  // より明るいホバー
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05);
        transition: all 0.2s ease;
      }
    }
    
    td {
      vertical-align: middle;
      padding: var(--spacing-3) var(--spacing-4);
    }
  }
}

// レスポンシブテーブル
.table-responsive {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  background-color: var(--bg-card);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-lg);
  padding: 0;
  
  .table {
    margin-bottom: 0;
    border: none;
  }
}

// ========================================
// 統一ナビゲーションスタイル
// ========================================

.navbar {
  @include navbar-base();
  
  .navbar-brand {
    @include navbar-brand();
  }
  
  .nav-link {
    @include navbar-nav-link();
  }
}

// ナビゲーション（管理者画面）
.navbar-admin {
  @include navbar-base(
    linear-gradient(135deg, var(--admin-primary), var(--admin-secondary))
  );
}

// ========================================
// 統一ドロップダウンスタイル
// ========================================

.dropdown-menu {
  @include dropdown-modern();
}

// ========================================
// アイコンラッパーシステム
// ========================================

.icon-wrapper {
  @include icon-wrapper();
  
  &.icon-primary {
    @include icon-wrapper(40px, rgba(var(--section-primary), 0.1), var(--section-primary));
  }
  
  &.icon-success {
    @include icon-wrapper(40px, rgba(40, 167, 69, 0.1), var(--bs-success));
  }
  
  &.icon-warning {
    @include icon-wrapper(40px, rgba(255, 193, 7, 0.1), var(--bs-warning));
  }
  
  &.icon-danger {
    @include icon-wrapper(40px, rgba(220, 53, 69, 0.1), var(--bs-danger));
  }
}

// ========================================
// モバイルファーストレスポンシブ
// ========================================

// モバイル最適化は各コンポーネントで個別に適用

// グリッドシステム拡張
.responsive-grid {
  @include responsive-grid();
}

// ========================================
// アクセシビリティ強化
// ========================================

// フォーカスリング統一
.form-control,
.btn,
.nav-link,
.dropdown-item {
  @include focus-ring();
}

// ハイコントラスト対応
@include high-contrast-support();

// 動作軽減対応
@include reduced-motion-support();

// スクリーンリーダー対応
.sr-only,
.visually-hidden {
  @include sr-only();
}

// ========================================
// パフォーマンス最適化
// ========================================

// GPU加速によるアニメーション最適化
.card,
.btn,
.navbar,
.alert {
  transform: translateZ(0);
  backface-visibility: hidden;
}

// ========================================
// プリント対応
// ========================================

@media print {
  .navbar,
  .footer,
  .btn,
  .alert {
    display: none !important;
  }
  
  .card {
    border: 1px solid #000 !important;
    box-shadow: none !important;
    page-break-inside: avoid;
  }
  
  body {
    background: white !important;
    color: black !important;
  }
}

// ========================================
// 環境別スタイル調整
// ========================================

// 開発環境でのデバッグ支援（環境変数チェック削除）
.debug-info {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 5px 10px;
  border-radius: 3px;
  font-size: 12px;
  z-index: 9999;
  display: none; // デフォルトで非表示
}

// ========================================
// レガシー互換性（段階的削除予定）
// ========================================

// 旧カラー定義（後方互換性のためのエイリアス）
:root {
  // 旧システムとの互換性
  --admin-primary: var(--brand-primary);
  --admin-secondary: var(--brand-secondary);
  --admin-accent: var(--admin-accent, var(--brand-primary));
  --admin-background: var(--bg-secondary);
  
  // 旧クラス名のサポート（非推奨）
  --primary-500: var(--brand-primary);
  --bs-admin-primary: var(--admin-primary);
}

// 旧ボタンクラスのエイリアス（非推奨 - 削除予定）
.btn-admin {
  @extend .btn-gradient-primary;
}

.btn-github {
  @include button-variant(
    #24292e,
    var(--text-light),
    #24292e,
    #1a1e23,
    var(--text-light),
    translateY(-1px)
  );
}

// 旧カードクラスのエイリアス（非推奨 - 削除予定）
.dashboard-card {
  @extend .card;
  @include card-hover-effect();
}

// ========================================
// TODO: 🔴 Phase 2（緊急）- レガシーファイル段階的統合
// 優先度: 高（メンテナンス性向上）
// 実装内容:
//   - store_selection.scssをcomponents/に移行
//   - bootstrap_enhancements.scssの機能をコンポーネントに分散
//   - admin_controllers.scssとの統合
//   - 重複スタイルの完全除去
// 期待効果: ファイル数30%削減、メンテナンス性向上
// 工数見積: 2-3日
// ========================================

// ========================================
// TODO: 🟡 Phase 3（重要）- CSS Grid統合
// 優先度: 中（レイアウトシステム現代化）
// 実装内容:
//   - CSS Gridレスポンシブミックスイン
//   - Flexboxとの使い分け指針
//   - IE11サポート終了対応
// 期待効果: より柔軟なレイアウト、コード簡素化
// 工数見積: 1-2日
// ========================================

// ========================================
// TODO: 🟢 Phase 4（推奨）- CSS-in-JS統合検討
// 優先度: 低（技術スタック現代化）
// 実装内容:
//   - Styled Componentsまたは類似ライブラリ検討
//   - コンポーネント単位でのスタイル管理
//   - Reactコンポーネントとの統合
// 期待効果: コンポーネント再利用性向上、型安全性
// 工数見積: 1-2週間
// 依存関係: フロントエンド技術スタック決定
// ========================================

// ============================================
// 🛠️ ログイン画面UI修正: バランスの取れたレイアウト
// 目的: 42%幅での縦長表示を解決し、適切なレイアウトに修正
// ============================================

// ログイン画面専用の調整
.gradient-bg {
  // カードの適切なサイズとレスポンシブ対応
  .card-custom {
    max-width: 650px !important; // 🛠️ 適度な最大幅設定
    min-height: auto !important; // 🛠️ 自然な高さ
    
    // 画面サイズ別の幅調整
    @media (min-width: 992px) {
      min-width: 500px !important; // 🛠️ 大画面での最小幅確保
    }
  }
  
  // タブナビゲーションの修正
  .nav-tabs-custom {
    .nav-link {
      min-height: 50px !important; // 🛠️ タブの最小高さ設定
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      padding: 0.75rem 1rem !important; // 🛠️ 適度なパディング
      white-space: nowrap !important; // 🛠️ テキストの改行防止
      
      @media (min-width: 768px) {
        min-height: 60px !important; // 🛠️ タブレット以上で高さ増加
        padding: 1rem 1.5rem !important;
      }
      
      // アイコンとテキストの間隔調整
      i {
        margin-right: 0.5rem !important;
        flex-shrink: 0 !important; // 🛠️ アイコンサイズ固定
      }
    }
  }
  
  // カードボディの調整
  .card-body {
    // レスポンシブパディング（より控えめに）
    padding: 1.5rem !important; // 🛠️ 基本パディング
    
    @media (min-width: 768px) {
      padding: 2rem !important; // 🛠️ タブレット以上
    }
    
    @media (min-width: 992px) {
      padding: 2.5rem !important; // 🛠️ デスクトップ
    }
  }
  
  // フォーム要素の最適化
  .form-control {
    min-height: 48px !important; // 🛠️ 十分な高さ確保
    padding: 0.75rem 1rem !important; // 🛠️ 適度なパディング
    font-size: 1rem !important; // 🛠️ 読みやすいフォントサイズ
    
    @media (min-width: 768px) {
      min-height: 52px !important;
      padding: 1rem 1.25rem !important;
    }
  }
  
  // ボタンサイズの調整
  .btn-lg {
    min-height: 50px !important; // 🛠️ ボタンの最小高さ
    padding: 0.875rem 2rem !important; // 🛠️ 適度なパディング
    font-size: 1.1rem !important; // 🛠️ 適切なフォントサイズ
    
    @media (min-width: 768px) {
      min-height: 56px !important;
      padding: 1rem 2.5rem !important;
      font-size: 1.125rem !important;
    }
  }
  
  // コンテンツの縦方向スペーシング調整
  .tab-content {
    .text-center {
      margin-bottom: 1.5rem !important; // 🛠️ セクション間の適度な間隔
    }
    
    .mb-3 {
      margin-bottom: 1rem !important; // 🛠️ フォーム要素間隔
    }
    
    .mb-4 {
      margin-bottom: 1.5rem !important; // 🛠️ セクション間隔
    }
  }
  
  // アイコン円形背景の調整
  .rounded-circle {
    flex-shrink: 0 !important; // 🛠️ アイコンサイズ固定
  }
  
  // ラベルとフォームの間隔調整
  .form-label {
    margin-bottom: 0.5rem !important; // 🛠️ ラベルとフィールドの間隔
    font-weight: 500 !important;
  }
  
  // チェックボックスエリアの調整
  .form-check {
    margin-bottom: 1.5rem !important; // 🛠️ チェックボックス下部余白
  }
  
  // アラートエリアの調整
  .alert {
    margin-top: 1rem !important;
    margin-bottom: 1rem !important;
    padding: 0.75rem 1rem !important; // 🛠️ コンパクトなアラート
  }
}