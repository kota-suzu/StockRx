<%# Bootstrap 5 ãƒ¢ãƒ€ãƒ³åœ¨åº«ãƒ•ã‚©ãƒ¼ãƒ  - StockRx å…¬é–‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ %>
<%= form_with(model: inventory, class: "needs-validation", novalidate: true, data: { turbo: false }) do |form| %>
  
  <%# ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º %>
  <% if inventory.errors.any? %>
    <div class="alert alert-danger mb-4" role="alert">
      <div class="d-flex align-items-start">
        <i class="fas fa-exclamation-triangle me-2 mt-1"></i>
        <div>
          <h6 class="alert-heading mb-2">
            <%= pluralize(inventory.errors.count, "ã¤ã®ã‚¨ãƒ©ãƒ¼") %> ãŒç™ºç”Ÿã—ã¾ã—ãŸ
          </h6>
          <ul class="mb-0">
            <% inventory.errors.each do |error| %>
              <li><%= error.full_message %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

  <%# å•†å“åãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ %>
  <div class="mb-4">
    <%= form.label :name, "å•†å“å", class: "form-label fw-medium" %>
    <div class="input-group">
      <span class="input-group-text bg-light">
        <i class="fas fa-box text-muted"></i>
      </span>
      <%= form.text_field :name, 
          class: "form-control form-control-lg", 
          placeholder: "å•†å“åã‚’å…¥åŠ›",
          required: true %>
      <div class="invalid-feedback">
        å•†å“åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

  <%# åœ¨åº«æ•°ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ %>
  <div class="mb-4">
    <%= form.label :quantity, "åœ¨åº«æ•°", class: "form-label fw-medium" %>
    <div class="input-group">
      <span class="input-group-text bg-light">
        <i class="fas fa-cubes text-muted"></i>
      </span>
      <%= form.number_field :quantity, 
          min: 0, 
          class: "form-control form-control-lg", 
          placeholder: "0",
          required: true %>
      <span class="input-group-text">å€‹</span>
      <div class="invalid-feedback">
        åœ¨åº«æ•°ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

  <%# å˜ä¾¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ %>
  <div class="mb-4">
    <%= form.label :price, "å˜ä¾¡", class: "form-label fw-medium" %>
    <div class="input-group">
      <span class="input-group-text bg-light">Â¥</span>
      <%= form.number_field :price, 
          min: 0, 
          step: 0.01, 
          class: "form-control form-control-lg", 
          placeholder: "0.00",
          required: true %>
      <div class="invalid-feedback">
        å˜ä¾¡ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

  <%# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ %>
  <div class="mb-4">
    <%= form.label :status, "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹", class: "form-label fw-medium" %>
    <div class="input-group">
      <span class="input-group-text bg-light">
        <i class="fas fa-info-circle text-muted"></i>
      </span>
      <%= form.select :status, 
          options_for_select(Inventory::STATUSES.map { |k, _| [k.humanize, k] }, inventory.status), 
          { include_blank: "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’é¸æŠ" }, 
          { class: "form-select form-select-lg", required: true } %>
      <div class="invalid-feedback">
        ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

  <%# ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ %>
  <div class="d-flex flex-column flex-sm-row justify-content-end gap-3 pt-4 border-top">
    <% if inventory.persisted? %>
      <%= link_to inventory_path(inventory), class: "btn btn-outline-secondary btn-lg" do %>
        <i class="fas fa-times me-2"></i>ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      <% end %>
    <% else %>
      <%= link_to inventories_path, class: "btn btn-outline-secondary btn-lg" do %>
        <i class="fas fa-times me-2"></i>ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      <% end %>
    <% end %>
    <%= form.submit (inventory.persisted? ? "æ›´æ–°ã™ã‚‹" : "ç™»éŒ²ã™ã‚‹"), 
        class: "btn btn-primary btn-lg",
        data: { 
          disable_with: '<i class="fas fa-spinner fa-spin me-2"></i>å‡¦ç†ä¸­...' 
        } do %>
      <i class="fas fa-<%= inventory.persisted? ? 'edit' : 'plus' %> me-2"></i>
      <%= inventory.persisted? ? 'æ›´æ–°ã™ã‚‹' : 'ç™»éŒ²ã™ã‚‹' %>
    <% end %>
  </div>
<% end %>

<%# Bootstrap 5 Form Validation JavaScript %>
<script>
(function() {
  'use strict';
  
  // ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  window.addEventListener('load', function() {
    var forms = document.getElementsByClassName('needs-validation');
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);

  // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  document.addEventListener('DOMContentLoaded', function() {
    const inputs = document.querySelectorAll('.form-control, .form-select');
    inputs.forEach(input => {
      input.addEventListener('input', function() {
        if (this.checkValidity()) {
          this.classList.remove('is-invalid');
          this.classList.add('is-valid');
        } else {
          this.classList.remove('is-valid');
          this.classList.add('is-invalid');
        }
      });
    });
  });
})();
</script>

<%# TODO: ğŸŸ¡ Phase 2 - ãƒ•ã‚©ãƒ¼ãƒ æ©Ÿèƒ½å¼·åŒ– %>
<%# å„ªå…ˆåº¦: ä¸­ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šï¼‰ %>
<%# å®Ÿè£…å†…å®¹: ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã‚«ãƒ†ã‚´ãƒªé¸æŠã€ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ %>
<%# ç†ç”±: å•†å“ç®¡ç†æ©Ÿèƒ½ã®å……å®Ÿ %>
<%# æœŸå¾…åŠ¹æœ: å•†å“ç™»éŒ²ã®åŠ¹ç‡åŒ–ã€è¦–èªæ€§å‘ä¸Š %>
<%# å·¥æ•°è¦‹ç©: 2æ—¥ %>
<%# ä¾å­˜é–¢ä¿‚: ç”»åƒå‡¦ç†gemã€ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒª %> 