<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>店舗選択 - StockRx</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta charset="utf-8">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <%# Bootstrap Icons (統一アイコンシステム) %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  </head>

  <body>
    <%# ヘッダー %>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <%= link_to root_path, class: "navbar-brand" do %>
          <i class="bi bi-boxes me-2"></i>
          StockRx
        <% end %>
        <span class="navbar-text text-white">
          店舗選択
        </span>
      </div>
    </nav>

    <%# メインコンテンツ %>
    <main class="py-5">
      <div class="container">
        <%# フラッシュメッセージ %>
        <% if flash.any? %>
          <% flash.each do |type, message| %>
            <div class="alert alert-<%= flash_class(type) %> alert-dismissible fade show" role="alert">
              <%= message %>
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          <% end %>
        <% end %>

        <%= yield %>
      </div>
    </main>

    <%# フッター %>
    <footer class="bg-light py-4 mt-auto">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <p class="text-muted mb-0">
              <i class="bi bi-shield-check me-1"></i>
              セキュアな店舗管理システム
            </p>
          </div>
          <div class="col-md-6 text-md-end">
            <%# CLAUDE.md準拠: セキュリティ強化 - 管理者ログインへの直接リンク削除 %>
            <%# 横展開: 他のレイアウトファイルと同様のセキュリティポリシー適用 %>
            <p class="text-muted mb-0">
              <i class="bi bi-info-circle me-1"></i>
              店舗ユーザー専用ページ
            </p>
          </div>
        </div>
      </div>
    </footer>

    <%# TODO: 🔴 Phase 2（セキュリティ）- 店舗選択セキュリティ強化 %>
    <%# 優先度: 高（認証セキュリティ） %>
    <%# 実装内容: %>
    <%#   - ✅ 管理者ログインへの直接リンク削除完了 %>
    <%#   - ⏳ 店舗アクセス履歴の監査ログ %>
    <%#   - ⏳ 異常アクセスパターン検知 %>
    <%#   - ⏳ 店舗別レート制限 %>
    <%#   - ⏳ 多要素認証検討（SMS、TOTP） %>
    <%# 横展開: store_auth.html.erb にも同様のセキュリティ対策適用 %>
    <%# 期待効果: 不正ログイン防止、店舗データ保護強化 %>
  </body>
</html>