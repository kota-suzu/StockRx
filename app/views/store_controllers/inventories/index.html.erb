<%# Â∫óËàóÂú®Â∫´‰∏ÄË¶ß„Éì„É•„Éº %>
<%# CLAUDE.mdÊ∫ñÊã†: „Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ - Â∫óËàó„É¶„Éº„Ç∂„ÉºÂêë„Åë„ÅÆÁõ¥ÊÑüÁöÑ„Å™Âú®Â∫´ÁÆ°ÁêÜÁîªÈù¢ %>
<%# „É°„ÇøË™çÁü•: ÁÆ°ÁêÜËÄÖÁîªÈù¢„Å®„ÅØÁï∞„Å™„Çä„ÄÅÂ∫óËàóÈÅãÂñ∂„Å´ÂøÖË¶Å„Å™Ê©üËÉΩ„ÅÆ„Åø„Å´ÁâπÂåñ %>
<%# Ê®™Â±ïÈñã: ‰ªñ„ÅÆÂ∫óËàó‰∏ÄË¶ßÁîªÈù¢„Åß„ÇÇÂêåÊßò„ÅÆUI„Éë„Çø„Éº„É≥„ÇíÈÅ©Áî® %>

<% content_for :title, "Âú®Â∫´ÁÆ°ÁêÜ" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h3 mb-1">
      <i class="bi bi-box-seam me-2"></i>Âú®Â∫´ÁÆ°ÁêÜ
    </h1>
    <p class="text-muted mb-0">
      <%= current_store.name %> „ÅÆÂú®Â∫´Áä∂Ê≥Å
    </p>
  </div>
  
  <div class="d-flex gap-2">
    <%# TODO: üü° Phase 3ÔºàÈáçË¶ÅÔºâ- CSVÂá∫ÂäõÊ©üËÉΩ %>
    <%# ÂÑ™ÂÖàÂ∫¶: ‰∏≠ÔºàÊ•≠ÂãôÂäπÁéáÂåñÔºâ %>
    <%# ÂÆüË£ÖÂÜÖÂÆπ: Â∫óËàóÂú®Â∫´„Éá„Éº„Çø„ÅÆCSV„Ç®„ÇØ„Çπ„Éù„Éº„Éà %>
    <%# „É°„ÇøË™çÁü•: Êú¨ÈÉ®„Å∏„ÅÆÂ†±Âëä„ÇÑÂàÜÊûê„Å´ÂøÖË¶Å„Å™Ê©üËÉΩ %>
    <button class="btn btn-outline-success" disabled>
      <i class="bi bi-download me-1"></i>CSVÂá∫Âäõ
    </button>
    
    <%# TODO: üü° Phase 3ÔºàÈáçË¶ÅÔºâ- Âú®Â∫´Ë™øÊï¥Ê©üËÉΩ %>
    <%# ÂÑ™ÂÖàÂ∫¶: ‰∏≠ÔºàÊ£öÂç∏„ÅóÂØæÂøúÔºâ %>
    <%# ÂÆüË£ÖÂÜÖÂÆπ: ÂÆüÂú®Â∫´Êï∞„Å®Â∏≥Á∞øÂú®Â∫´Êï∞„ÅÆË™øÊï¥Ê©üËÉΩ %>
    <%# „É°„ÇøË™çÁü•: Êó•Â∏∏ÁöÑ„Å™Â∫óËàóÊ•≠Âãô„ÅßÂøÖÈ†à„ÅÆÊ©üËÉΩ %>
    <button class="btn btn-primary" disabled>
      <i class="bi bi-clipboard-check me-1"></i>Âú®Â∫´Ë™øÊï¥
    </button>
  </div>
</div>

<%# Áµ±Ë®à„Çµ„Éû„É™„Éº %>
<div class="row g-3 mb-4">
  <div class="col-sm-6 col-lg-3">
    <div class="card bg-primary text-white">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <i class="bi bi-boxes display-6"></i>
          </div>
          <div>
            <div class="h4 mb-0"><%= @statistics[:total_items] %></div>
            <div class="small">ÂïÜÂìÅÁ®ÆÈ°û</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-sm-6 col-lg-3">
    <div class="card bg-success text-white">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <i class="bi bi-stack display-6"></i>
          </div>
          <div>
            <div class="h4 mb-0"><%= number_with_delimiter(@statistics[:total_quantity]) %></div>
            <div class="small">Á∑èÂú®Â∫´Êï∞</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-sm-6 col-lg-3">
    <div class="card bg-info text-white">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <i class="bi bi-currency-yen display-6"></i>
          </div>
          <div>
            <div class="h4 mb-0">¬•<%= number_with_delimiter(@statistics[:total_value]) %></div>
            <div class="small">Á∑èÂú®Â∫´ÈáëÈ°ç</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-sm-6 col-lg-3">
    <div class="card bg-warning text-dark">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <i class="bi bi-exclamation-triangle display-6"></i>
          </div>
          <div>
            <div class="h4 mb-0"><%= @statistics[:low_stock_percentage] %>%</div>
            <div class="small">‰ΩéÂú®Â∫´Áéá</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%# Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº %>
<div class="card mb-4">
  <div class="card-header">
    <h5 class="card-title mb-0">
      <i class="bi bi-funnel me-2"></i>Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº
    </h5>
  </div>
  <div class="card-body">
    <%# CLAUDE.mdÊ∫ñÊã†: Ê®™Â±ïÈñã - „É´„Éº„ÉÜ„Ç£„É≥„Ç∞Ë°ùÁ™ÅÂïèÈ°å„ÅÆËß£Ê±∫ %>
    <%# „É°„ÇøË™çÁü•: ÂÖ¨Èñã„É´„Éº„Éà(/stores/:store_id/inventories)„Å®Ë™çË®ºÊ∏à„Åø„É´„Éº„Éà(/store/inventories)„ÅÆÂå∫Âà• %>
    <%# „Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ: ÊòéÁ§∫ÁöÑ„Éë„ÇπÊåáÂÆö„ÅßÊõñÊòßÊÄß„ÇíÊéíÈô§ %>
    <%# CLAUDE.mdÊ∫ñÊã†: ransackÂâäÈô§Âæå„ÅÆ‰ª£ÊõøÂÆüË£Ö %>
    <%# „É°„ÇøË™çÁü•: search_form_for„ÅØransackÂõ∫Êúâ„ÅÆ„Åü„ÇÅ„ÄÅÊ®ôÊ∫ñÁöÑ„Å™form_with„Çí‰ΩøÁî® %>
    <%# „Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ: Ê§úÁ¥¢„Éë„É©„É°„Éº„Çø„Çíq„Éè„ÉÉ„Ç∑„É•„ÅßÊßãÈÄ†Âåñ„Åó„Å¶‰∫íÊèõÊÄßÁ∂≠ÊåÅ %>
    <%# Ê®™Â±ïÈñã: ‰ªñ„ÅÆÊ§úÁ¥¢„Éï„Ç©„Éº„É†„Åß„ÇÇÂêåÊßò„ÅÆ‰øÆÊ≠£ÈÅ©Áî®ÂøÖË¶Å %>
    <%# TODO: üü° Phase 3ÔºàÈáçË¶ÅÔºâ- È´òÂ∫¶„Å™Ê§úÁ¥¢Ê©üËÉΩ„ÅÆÂÆüË£Ö %>
    <%# ÂÑ™ÂÖàÂ∫¶: ‰∏≠Ôºà„É¶„Éº„Ç∂„Éì„É™„ÉÜ„Ç£Âêë‰∏äÔºâ %>
    <%# ÂÆüË£ÖÂÜÖÂÆπ: %>
    <%#   - „É™„Ç¢„É´„Çø„Ç§„É†Ê§úÁ¥¢ÔºàStimulus/Turbo FramesÊ¥ªÁî®Ôºâ %>
    <%#   - Ê§úÁ¥¢Â±•Ê≠¥„Éª„ÅäÊ∞ó„Å´ÂÖ•„ÇäÊ§úÁ¥¢Êù°‰ª∂‰øùÂ≠ò %>
    <%#   - Ë§áÊï∞Êù°‰ª∂„ÅÆAND/ORÁµÑ„ÅøÂêà„Çè„Åõ %>
    <%#   - CSV„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Å´Ê§úÁ¥¢Êù°‰ª∂ÂèçÊò† %>
    <%# ÊúüÂæÖÂäπÊûú: Ê§úÁ¥¢ÂäπÁéá50%Âêë‰∏ä„ÄÅÊ•≠ÂãôÊôÇÈñìÁü≠Á∏Æ %>
    <%= form_with url: "/store/inventories", method: :get, local: true, class: "row g-3" do |f| %>
      <div class="col-md-3">
        <%= f.text_field "q[name_cont]", 
                         placeholder: "ÂïÜÂìÅÂêç„ÅßÊ§úÁ¥¢", 
                         class: "form-control", 
                         value: params.dig(:q, :name_cont) %>
      </div>
      
      <div class="col-md-2">
        <%= f.select "q[manufacturer_eq]", 
                     options_for_select([['„É°„Éº„Ç´„Éº„ÇíÈÅ∏Êäû', '']] + @manufacturers.map { |m| [m, m] },
                                       params.dig(:q, :manufacturer_eq)),
                     {},
                     { class: "form-select" } %>
      </div>
      
      <div class="col-md-2">
        <%= f.select "q[stock_level_eq]", 
                     options_for_select([['Âú®Â∫´Áä∂ÊÖã„ÇíÈÅ∏Êäû', '']] + @stock_levels,
                                       params.dig(:q, :stock_level_eq)),
                     {},
                     { class: "form-select" } %>
      </div>
      
      <div class="col-md-3">
        <div class="input-group">
          <%= f.number_field "q[quantity_gteq]", 
                             placeholder: "ÊúÄÂ∞èÂú®Â∫´Êï∞", 
                             class: "form-control",
                             value: params.dig(:q, :quantity_gteq) %>
          <span class="input-group-text">„Äú</span>
          <%= f.number_field "q[quantity_lteq]", 
                             placeholder: "ÊúÄÂ§ßÂú®Â∫´Êï∞", 
                             class: "form-control",
                             value: params.dig(:q, :quantity_lteq) %>
        </div>
      </div>
      
      <div class="col-md-2">
        <div class="d-flex gap-2">
          <%= f.submit "Ê§úÁ¥¢", class: "btn btn-primary" %>
          <%# Ê®™Â±ïÈñã: ÂêåÊßò„ÅÆ„É´„Éº„ÉÜ„Ç£„É≥„Ç∞‰øÆÊ≠£ %>
          <%= link_to "„ÇØ„É™„Ç¢", "/store/inventories", class: "btn btn-outline-secondary" %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<%# Âú®Â∫´‰∏ÄË¶ß„ÉÜ„Éº„Éñ„É´ %>
<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="card-title mb-0">
      <i class="bi bi-list me-2"></i>Âú®Â∫´‰∏ÄË¶ß
    </h5>
    <small class="text-muted">
      <%= @store_inventories.total_count %>‰ª∂‰∏≠ 
      <%= @store_inventories.offset_value + 1 %>-<%= [@store_inventories.offset_value + @store_inventories.limit_value, @store_inventories.total_count].min %>‰ª∂„ÇíË°®Á§∫
    </small>
  </div>
  
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>
              <%# Ê®™Â±ïÈñã: „ÇΩ„Éº„Éà„É™„É≥„ÇØ„ÇÇÂêåÊßò„Å´„É´„Éº„ÉÜ„Ç£„É≥„Ç∞‰øÆÊ≠£ %>
              <%= link_to "/store/inventories?#{params.permit!.merge(sort: 'inventories.name', direction: sort_direction == 'asc' ? 'desc' : 'asc').to_query}", 
                          class: "text-decoration-none" do %>
                <i class="bi bi-box me-1"></i>ÂïÜÂìÅÂêç
                <% if params[:sort] == 'inventories.name' %>
                  <i class="bi bi-chevron-<%= sort_direction == 'asc' ? 'up' : 'down' %>"></i>
                <% end %>
              <% end %>
            </th>
            <th>
              <%# Ê®™Â±ïÈñã: Âú®Â∫´Êï∞„ÇΩ„Éº„Éà„É™„É≥„ÇØ„ÇÇÂêåÊßò„Å´‰øÆÊ≠£ %>
              <%= link_to "/store/inventories?#{params.permit!.merge(sort: 'quantity', direction: sort_direction == 'asc' ? 'desc' : 'asc').to_query}", 
                          class: "text-decoration-none" do %>
                <i class="bi bi-stack me-1"></i>Âú®Â∫´Êï∞
                <% if params[:sort] == 'quantity' %>
                  <i class="bi bi-chevron-<%= sort_direction == 'asc' ? 'up' : 'down' %>"></i>
                <% end %>
              <% end %>
            </th>
            <th><i class="bi bi-shield-check me-1"></i>ÂÆâÂÖ®Âú®Â∫´</th>
            <th><i class="bi bi-currency-yen me-1"></i>Âçò‰æ°</th>
            <th><i class="bi bi-traffic-light me-1"></i>Áä∂ÊÖã</th>
            <th><i class="bi bi-clock me-1"></i>ÂõûËª¢Êó•Êï∞</th>
            <th class="text-end"><i class="bi bi-gear me-1"></i>„Ç¢„ÇØ„Ç∑„Éß„É≥</th>
          </tr>
        </thead>
        <tbody>
          <% if @store_inventories.present? %>
            <% @store_inventories.each do |store_inventory| %>
              <tr>
                <td>
                  <div class="d-flex align-items-center">
                    <div>
                      <div class="fw-bold">
                        <%# Ê®™Â±ïÈñã: ÂÄãÂà•Âú®Â∫´Ë©≥Á¥∞„É™„É≥„ÇØ„ÇÇ‰øÆÊ≠£ %>
                        <%= link_to store_inventory.inventory.name, 
                                    "/store/inventories/#{store_inventory.inventory.id}", 
                                    class: "text-decoration-none" %>
                      </div>
                      <% if store_inventory.inventory.manufacturer.present? %>
                        <small class="text-muted">
                          <i class="bi bi-building me-1"></i><%= store_inventory.inventory.manufacturer %>
                        </small>
                      <% end %>
                    </div>
                  </div>
                </td>
                
                <td>
                  <span class="badge bg-secondary fs-6">
                    <%= store_inventory.quantity %> ÂÄã
                  </span>
                  <% if store_inventory.quantity > 0 %>
                    <div class="progress mt-1" style="height: 4px;">
                      <% percentage = [(store_inventory.quantity.to_f / (store_inventory.safety_stock_level * 2) * 100), 100].min %>
                      <div class="progress-bar bg-info" style="width: <%= percentage %>%"></div>
                    </div>
                  <% end %>
                </td>
                
                <td>
                  <span class="badge bg-outline-secondary">
                    <%= store_inventory.safety_stock_level %> ÂÄã
                  </span>
                </td>
                
                <td>
                  <span class="text-success fw-bold">
                    ¬•<%= number_with_delimiter(store_inventory.inventory.price) %>
                  </span>
                </td>
                
                <td>
                  <% badge = stock_level_badge(store_inventory) %>
                  <span class="<%= badge[:class] %>"><%= badge[:text] %></span>
                </td>
                
                <td>
                  <span class="badge bg-light text-dark">
                    <%= turnover_days(store_inventory) %> Êó•
                  </span>
                </td>
                
                <td class="text-end">
                  <div class="btn-group" role="group">
                    <%# Ê®™Â±ïÈñã: Ë©≥Á¥∞Ë°®Á§∫„Éú„Çø„É≥„ÇÇÂêåÊßò„Å´‰øÆÊ≠£ %>
                    <%= link_to "/store/inventories/#{store_inventory.inventory.id}", 
                                class: "btn btn-outline-primary btn-sm",
                                title: "Ë©≥Á¥∞Ë°®Á§∫" do %>
                      <i class="bi bi-eye"></i>
                    <% end %>
                    
                    <%# TODO: üü° Phase 3ÔºàÈáçË¶ÅÔºâ- Âú®Â∫´Ë™øÊï¥Ê©üËÉΩ %>
                    <button class="btn btn-outline-warning btn-sm" disabled title="Âú®Â∫´Ë™øÊï¥ÔºàÂÆüË£Ö‰∫àÂÆöÔºâ">
                      <i class="bi bi-pencil"></i>
                    </button>
                    
                    <%# TODO: üü° Phase 3ÔºàÈáçË¶ÅÔºâ- ÁßªÂãïÁî≥Ë´ãÊ©üËÉΩ %>
                    <button class="btn btn-outline-info btn-sm" disabled title="ÁßªÂãïÁî≥Ë´ãÔºàÂÆüË£Ö‰∫àÂÆöÔºâ">
                      <i class="bi bi-arrow-left-right"></i>
                    </button>
                  </div>
                </td>
              </tr>
            <% end %>
          <% else %>
            <tr>
              <td colspan="7" class="text-center py-5">
                <div class="text-muted">
                  <i class="bi bi-box display-4 mb-3"></i>
                  <h6>Âú®Â∫´„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</h6>
                  <p class="mb-0">Êù°‰ª∂„ÇíÂ§âÊõ¥„Åó„Å¶ÂÜçÂ∫¶Ê§úÁ¥¢„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  
  <%# „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ %>
  <% if @store_inventories.present? %>
    <div class="card-footer">
      <%= paginate @store_inventories, theme: :bootstrap_5 %>
    </div>
  <% end %>
</div>

<%# TODO: üü° Phase 3ÔºàÈáçË¶ÅÔºâ- Â∫óËàóÂú®Â∫´ÁÆ°ÁêÜÊ©üËÉΩ„ÅÆÊã°Âºµ %>
<%# ÂÑ™ÂÖàÂ∫¶: ‰∏≠ÔºàÊ•≠ÂãôÂäπÁéáÂåñÔºâ %>
<%# ÂÆüË£ÖÂÜÖÂÆπ: %>
<%#   - Âú®Â∫´Ë™øÊï¥ÔºàÊ£öÂç∏„ÅóÔºâÊ©üËÉΩ %>
<%#   - Â∫óËàóÈñìÁßªÂãïÁî≥Ë´ãÊ©üËÉΩ %>
<%#   - CSVÂá∫ÂäõÊ©üËÉΩ %>
<%#   - Âú®Â∫´„Ç¢„É©„Éº„ÉàË®≠ÂÆö %>
<%#   - „É™„Ç¢„É´„Çø„Ç§„É†Âú®Â∫´Êõ¥Êñ∞ %>
<%# ÊúüÂæÖÂäπÊûú: Â∫óËàóÊ•≠Âãô„ÅÆÂ§ßÂπÖ„Å™ÂäπÁéáÂåñ„ÄÅÊ≠£Á¢∫„Å™Âú®Â∫´ÁÆ°ÁêÜ %>
<%# Ê®™Â±ïÈñã: ‰ªñ„ÅÆÂ∫óËàóÊ©üËÉΩ„Åß„ÇÇÂêåÊßò„ÅÆUI„Éë„Çø„Éº„É≥„Å®„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÇíÈÅ©Áî® %>