<%# 管理者用店舗間移動詳細ビュー %>
<%# CLAUDE.md準拠: ベストプラクティス - 店舗側と一貫したUIパターンの適用 %>
<%# メタ認知: 左に移動元、右に移動先の直感的レイアウトで認知負荷を軽減 %>
<%# 横展開: 店舗側show.html.erbと同様のUIパターンを管理者機能と融合 %>

<% content_for :title, "移動申請詳細 ##{@transfer&.id}" %>

<div class="row">
  <div class="col-12">
    <%# パンくずナビ %>
    <nav aria-label="breadcrumb" class="mb-3">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <%= link_to admin_root_path do %>
            <i class="bi bi-house-door"></i> ダッシュボード
          <% end %>
        </li>
        <li class="breadcrumb-item">
          <%= link_to admin_inter_store_transfers_path do %>
            <i class="bi bi-arrow-left-right"></i> 移動管理
          <% end %>
        </li>
        <li class="breadcrumb-item active" aria-current="page">
          詳細 #<%= @transfer&.id %>
        </li>
      </ol>
    </nav>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <%# ページヘッダー %>
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="h3 mb-1">
          <i class="bi bi-truck me-2"></i>移動申請 #<%= @transfer.id %>
        </h1>
        <p class="text-muted mb-0">
          申請日: <%= l(@transfer.requested_at, format: :long) %>
        </p>
      </div>
      
      <div class="d-flex gap-2">
        <%= link_to admin_inter_store_transfers_path, class: "btn btn-secondary" do %>
          <i class="bi bi-arrow-left me-1"></i>一覧に戻る
        <% end %>
      </div>
    </div>
  </div>
</div>

<%# 移動ステータス & 商品情報ヘッダー %>
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card-body p-4">
        <div class="row align-items-center">
          <div class="col-lg-6">
            <div class="d-flex align-items-center">
              <div class="me-4">
                <h5 class="mb-1 fw-bold">
                  <i class="bi bi-box-seam me-2 text-primary"></i>
                  <%= @transfer.inventory&.name %>
                </h5>
                <p class="text-muted mb-0">
                  <small>
                    <% # TODO: 🟡 Phase 5（重要）- JANコード機能実装時に復活予定 %>
                    <% # 優先度: 中（バーコードスキャン機能と連携） %>
                    <% # 実装内容: %>
                    <% #   - マイグレーション: jan_codeカラム追加 %>
                    <% #   - Inventoryモデル: jan_codeバリデーション追加 %>
                    <% #   - ビュー表示: SKU・JANコード両方対応 %>
                    <% # 期待効果: 商品識別精度向上、バーコード連携 %>
                    <% # メタ認知: 現在はskuフィールドで代替機能提供 %>
                    <% # 横展開: 他の商品表示箇所でも同様の実装必要 %>
                    <% if @transfer.inventory&.sku.present? %>
                      SKU: <%= @transfer.inventory.sku %> |
                    <% end %>
                    申請者: <%= @transfer.requested_by&.display_name %>
                  </small>
                </p>
              </div>
              <div class="mx-4">
                <span class="badge bg-info fs-6 px-3 py-2">
                  <i class="bi bi-arrow-left-right me-1"></i>
                  <%= number_with_delimiter(@transfer.quantity) %> 個
                </span>
              </div>
            </div>
          </div>
          <div class="col-lg-6 text-lg-end">
            <div class="d-flex gap-2 justify-content-lg-end flex-wrap">
              <%# ステータスバッジ %>
              <span class="badge bg-<%= @transfer.status == 'completed' ? 'success' : 
                                     @transfer.status == 'pending' ? 'warning' : 
                                     @transfer.status == 'approved' ? 'info' : 
                                     @transfer.status == 'in_transit' ? 'primary' : 'secondary' %> fs-6 px-3 py-2">
                <i class="bi bi-<%= @transfer.status == 'completed' ? 'check-circle' : 
                                  @transfer.status == 'pending' ? 'clock' : 
                                  @transfer.status == 'approved' ? 'check' : 
                                  @transfer.status == 'in_transit' ? 'truck' : 'x-circle' %> me-1"></i>
                <%= @transfer.status_text %>
              </span>
              
              <%# 優先度バッジ %>
              <% if @transfer.priority.present? && %w[emergency urgent].include?(@transfer.priority) %>
                <span class="badge bg-<%= @transfer.priority == 'emergency' ? 'danger' : 'warning' %> fs-6 px-3 py-2">
                  <i class="bi bi-exclamation-triangle me-1"></i>
                  <%= @transfer.priority_text %>
                </span>
              <% end %>
            </div>
          </div>
        </div>
        
        <% if @transfer.reason.present? %>
          <div class="mt-3 pt-3 border-top">
            <h6 class="text-muted mb-2">
              <i class="bi bi-chat-left-text me-1"></i>申請理由
            </h6>
            <p class="mb-0 bg-light p-3 rounded"><%= simple_format(@transfer.reason) %></p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<%# 移動元 ←→ 移動先 レイアウト %>
<div class="row g-4 mb-4">
  <%# 移動元店舗 %>
  <div class="col-lg-4">
    <div class="card h-100 border-start border-danger border-4">
      <div class="card-header bg-danger text-white">
        <h5 class="card-title mb-0">
          <i class="bi bi-shop me-2"></i>移動元
        </h5>
      </div>
      <div class="card-body">
        <%# 店舗情報 %>
        <div class="mb-4">
          <h6 class="fw-bold text-danger mb-2">
            <%= @transfer.source_store&.name %>
          </h6>
          <p class="text-muted small mb-1">
            <i class="bi bi-geo-alt me-1"></i>
            <%= @transfer.source_store&.address || '住所未設定' %>
          </p>
          <p class="text-muted small mb-1">
            <i class="bi bi-tag me-1"></i>
            店舗種別: <%= @transfer.source_store&.store_type&.humanize || '未設定' %>
          </p>
          <p class="text-muted small mb-0">
            <i class="bi bi-hash me-1"></i>
            店舗コード: <%= @transfer.source_store&.code || '未設定' %>
          </p>
        </div>

        <%# 移動元在庫情報 %>
        <div class="bg-light p-3 rounded">
          <h6 class="text-muted mb-3">
            <i class="bi bi-box me-1"></i>在庫状況
          </h6>
          <% if @source_inventory %>
            <div class="row g-2 text-center">
              <div class="col-6">
                <div class="small text-muted">現在数量</div>
                <div class="fw-bold text-primary fs-5">
                  <%= number_with_delimiter(@source_inventory.quantity) %>
                </div>
              </div>
              <div class="col-6">
                <div class="small text-muted">安全在庫</div>
                <div class="fw-bold text-info fs-5">
                  <%= number_with_delimiter(@source_inventory.safety_stock_level) %>
                </div>
              </div>
            </div>
            
            <%# 在庫レベル警告 %>
            <% if @source_inventory.quantity <= @source_inventory.safety_stock_level %>
              <div class="alert alert-warning mt-3 mb-0 py-2">
                <i class="bi bi-exclamation-triangle me-1"></i>
                <small>安全在庫レベル以下です</small>
              </div>
            <% end %>
          <% else %>
            <div class="text-muted text-center py-3">
              <i class="bi bi-exclamation-circle me-1"></i>
              在庫情報が見つかりません
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <%# 移動フロー（中央）+ 管理者操作 %>
  <div class="col-lg-4">
    <div class="card h-100">
      <div class="card-header bg-primary text-white">
        <h5 class="card-title mb-0">
          <i class="bi bi-gear me-2"></i>管理者操作
        </h5>
      </div>
      <div class="card-body d-flex flex-column">
        <%# 移動フロー表示 %>
        <div class="text-center mb-4">
          <div class="d-flex align-items-center justify-content-center mb-3">
            <i class="bi bi-arrow-right text-primary" style="font-size: 2.5rem;"></i>
          </div>
          
          <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center mx-auto" 
               style="width: 60px; height: 60px;">
            <span class="fw-bold"><%= @transfer.quantity %></span>
          </div>
          <div class="small text-muted mt-2">移動数量</div>
          
          <%# 進行状況 %>
          <div class="mt-4">
            <div class="small text-muted mb-2">進行状況</div>
            <div class="progress" style="height: 8px;">
              <% progress_percentage = case @transfer.status
                                      when 'pending' then 25
                                      when 'approved' then 50
                                      when 'in_transit', 'shipped' then 75
                                      when 'completed' then 100
                                      else 0
                                      end %>
              <div class="progress-bar bg-<%= @transfer.status == 'completed' ? 'success' : 'info' %>" 
                   style="width: <%= progress_percentage %>%"></div>
            </div>
            <div class="small text-muted mt-1"><%= progress_percentage %>% 完了</div>
          </div>
        </div>

        <%# 管理者操作ボタン %>
        <div class="mt-auto">
          <% if @transfer.pending? && current_admin.can_approve_transfers? %>
            <div class="d-grid gap-2 mb-3">
              <%= form_with url: approve_admin_inter_store_transfer_path(@transfer), method: :patch, local: true do |f| %>
                <%= f.submit "承認", class: "btn btn-success", 
                    confirm: "移動申請を承認しますか？" %>
              <% end %>
              
              <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#rejectModal">
                却下
              </button>
            </div>
          <% end %>
          
          <% if @transfer.completable? && current_admin.can_approve_transfers? %>
            <div class="d-grid gap-2 mb-3">
              <%= form_with url: complete_admin_inter_store_transfer_path(@transfer), method: :patch, local: true do |f| %>
                <%= f.submit "移動完了", class: "btn btn-primary", 
                    confirm: "移動を完了しますか？在庫が実際に移動されます。" %>
              <% end %>
            </div>
          <% end %>

          <% if @transfer.pending? && 
                (current_admin.headquarters_admin? || 
                 @transfer.requested_by == current_admin) %>
            <%= link_to edit_admin_inter_store_transfer_path(@transfer), 
                class: "btn btn-outline-secondary w-100" do %>
              <i class="bi bi-pencil me-1"></i>編集
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <%# 移動先店舗 %>
  <div class="col-lg-4">
    <div class="card h-100 border-start border-success border-4">
      <div class="card-header bg-success text-white">
        <h5 class="card-title mb-0">
          <i class="bi bi-shop me-2"></i>移動先
        </h5>
      </div>
      <div class="card-body">
        <%# 店舗情報 %>
        <div class="mb-4">
          <h6 class="fw-bold text-success mb-2">
            <%= @transfer.destination_store&.name %>
          </h6>
          <p class="text-muted small mb-1">
            <i class="bi bi-geo-alt me-1"></i>
            <%= @transfer.destination_store&.address || '住所未設定' %>
          </p>
          <p class="text-muted small mb-1">
            <i class="bi bi-tag me-1"></i>
            店舗種別: <%= @transfer.destination_store&.store_type&.humanize || '未設定' %>
          </p>
          <p class="text-muted small mb-0">
            <i class="bi bi-hash me-1"></i>
            店舗コード: <%= @transfer.destination_store&.code || '未設定' %>
          </p>
        </div>

        <%# 移動先在庫情報 %>
        <div class="bg-light p-3 rounded">
          <h6 class="text-muted mb-3">
            <i class="bi bi-box me-1"></i>受入れ後の在庫状況
          </h6>
          <% if @destination_inventory %>
            <div class="row g-2 text-center">
              <div class="col-6">
                <div class="small text-muted">現在数量</div>
                <div class="fw-bold text-primary fs-5">
                  <%= number_with_delimiter(@destination_inventory.quantity) %>
                </div>
              </div>
              <div class="col-6">
                <div class="small text-muted">受入れ後</div>
                <div class="fw-bold text-success fs-5">
                  <%= number_with_delimiter(@destination_inventory.quantity + (@transfer.status == 'completed' ? 0 : @transfer.quantity)) %>
                </div>
              </div>
            </div>
            
            <%# 移動後の在庫レベル予測 %>
            <% projected_quantity = @destination_inventory.quantity + (@transfer.status == 'completed' ? 0 : @transfer.quantity) %>
            <% if projected_quantity > @destination_inventory.safety_stock_level * 2 %>
              <div class="alert alert-info mt-3 mb-0 py-2">
                <i class="bi bi-info-circle me-1"></i>
                <small>移動後は過剰在庫レベルになります</small>
              </div>
            <% elsif projected_quantity >= @destination_inventory.safety_stock_level %>
              <div class="alert alert-success mt-3 mb-0 py-2">
                <i class="bi bi-check-circle me-1"></i>
                <small>移動後は適正在庫レベルです</small>
              </div>
            <% end %>
          <% else %>
            <div class="text-muted text-center py-3">
              <i class="bi bi-plus-circle me-1"></i>
              新規在庫として追加されます
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<%# 管理者向け詳細分析情報 %>
<div class="row g-4 mb-4">
  <div class="col-lg-8">
    <%# タイムライン履歴（下部） %>
    <div class="card">
      <div class="card-header bg-secondary text-white">
        <h5 class="card-title mb-0">
          <i class="bi bi-clock-history me-2"></i>移動履歴タイムライン
        </h5>
      </div>
      <div class="card-body">
        <%# 管理者向け詳細タイムライン表示 %>
        <div class="timeline-horizontal">
          <% if defined?(@timeline_events) && @timeline_events.present? %>
            <% @timeline_events.each_with_index do |event, index| %>
              <div class="timeline-step <%= 'active' if event[:timestamp] <= Time.current %> <%= 'completed' if index < @timeline_events.length - 1 %>">
                <div class="timeline-step-icon bg-<%= event[:color] %>">
                  <i class="<%= event[:icon] %>"></i>
                </div>
                <div class="timeline-step-content">
                  <h6 class="mb-1"><%= event[:event].humanize %></h6>
                  <p class="text-muted small mb-1">
                    <%= l(event[:timestamp], format: :long) if event[:timestamp] %>
                  </p>
                  <% if event[:user] %>
                    <p class="text-muted small mb-0">
                      <i class="bi bi-person me-1"></i><%= event[:user]&.display_name %>
                    </p>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% else %>
            <%# 簡易タイムライン（@timeline_eventsが定義されていない場合） %>
            <div class="timeline-step completed">
              <div class="timeline-step-icon bg-primary">
                <i class="bi bi-plus-circle"></i>
              </div>
              <div class="timeline-step-content">
                <h6 class="mb-1">申請</h6>
                <p class="text-muted small mb-1">
                  <%= l(@transfer.requested_at, format: :long) %>
                </p>
                <p class="text-muted small mb-0">
                  <i class="bi bi-person me-1"></i><%= @transfer.requested_by&.display_name %>
                </p>
              </div>
            </div>
            
            <% if @transfer.approved_at.present? %>
              <div class="timeline-step completed">
                <div class="timeline-step-icon bg-<%= @transfer.status == 'rejected' ? 'danger' : 'success' %>">
                  <i class="bi bi-<%= @transfer.status == 'rejected' ? 'x-circle' : 'check-circle' %>"></i>
                </div>
                <div class="timeline-step-content">
                  <h6 class="mb-1"><%= @transfer.status == 'rejected' ? '却下' : '承認' %></h6>
                  <p class="text-muted small mb-1">
                    <%= l(@transfer.approved_at, format: :long) %>
                  </p>
                  <% if @transfer.approved_by %>
                    <p class="text-muted small mb-0">
                      <i class="bi bi-person me-1"></i><%= @transfer.approved_by.display_name %>
                    </p>
                  <% end %>
                </div>
              </div>
            <% end %>
            
            <% if @transfer.completed_at.present? %>
              <div class="timeline-step completed">
                <div class="timeline-step-icon bg-success">
                  <i class="bi bi-check-all"></i>
                </div>
                <div class="timeline-step-content">
                  <h6 class="mb-1">完了</h6>
                  <p class="text-muted small mb-1">
                    <%= l(@transfer.completed_at, format: :long) %>
                  </p>
                  <p class="text-muted small mb-0">
                    <i class="bi bi-stopwatch me-1"></i>
                    処理時間: <%= distance_of_time_in_words(@transfer.requested_at, @transfer.completed_at) %>
                  </p>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <%# 分析情報 %>
    <div class="card h-100">
      <div class="card-header bg-info text-white">
        <h5 class="mb-0">
          <i class="bi bi-graph-up me-2"></i>分析情報
        </h5>
      </div>
      <div class="card-body">
        <% if defined?(@transfer_analytics) && @transfer_analytics.present? %>
          <div class="row text-center">
            <div class="col-12 mb-3">
              <h6 class="text-muted small">処理効率</h6>
              <div class="h4 text-primary">
                <%= @transfer_analytics[:route_efficiency] %>%
              </div>
              <div class="progress" style="height: 6px;">
                <div class="progress-bar bg-primary" 
                     style="width: <%= @transfer_analytics[:route_efficiency] %>%"></div>
              </div>
            </div>
            
            <div class="col-6 mb-3">
              <h6 class="text-muted small">類似移動</h6>
              <div class="h5 text-info">
                <%= @transfer_analytics[:similar_transfers_count] %>件
              </div>
            </div>
            
            <div class="col-6 mb-3">
              <h6 class="text-muted small">平均処理時間</h6>
              <div class="h5 text-warning">
                <%= @transfer_analytics[:average_similar_time] %>h
              </div>
            </div>
          </div>
          
          <% if @transfer_analytics[:average_similar_time] > 0 %>
            <hr class="my-3">
            <div class="text-center">
              <small class="text-muted">
                同じルートの移動申請平均処理時間と比較
              </small>
            </div>
          <% end %>
        <% else %>
          <%# 分析データが利用できない場合 %>
          <div class="text-center">
            <div class="row g-3">
              <div class="col-12">
                <div class="bg-light p-3 rounded">
                  <h6 class="text-muted mb-2">在庫移動金額</h6>
                  <div class="h5 text-success mb-0">
                    ¥<%= number_with_delimiter(@transfer.quantity * (@transfer.inventory&.price || 0)) %>
                  </div>
                </div>
              </div>
              
              <div class="col-6">
                <div class="text-center">
                  <div class="h6 text-primary">
                    <%= @transfer.priority&.humanize || '通常' %>
                  </div>
                  <small class="text-muted">優先度</small>
                </div>
              </div>
              
              <div class="col-6">
                <div class="text-center">
                  <div class="h6 text-info">
                    <%= (@transfer.completed_at ? 
                          distance_of_time_in_words(@transfer.requested_at, @transfer.completed_at) : 
                          distance_of_time_in_words(@transfer.requested_at, Time.current)) %>
                  </div>
                  <small class="text-muted">経過時間</small>
                </div>
              </div>
            </div>
            
            <hr class="my-3">
            <small class="text-muted">
              <i class="bi bi-info-circle me-1"></i>
              詳細分析は今後のアップデートで利用可能になります
            </small>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<%# 関連移動（管理者向け詳細） %>
<% if defined?(@related_transfers) && @related_transfers&.any? %>
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-arrow-repeat me-2"></i>関連する移動申請
          </h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead class="table-light">
                <tr>
                  <th><i class="bi bi-calendar me-1"></i>申請日</th>
                  <th><i class="bi bi-traffic-light me-1"></i>ステータス</th>
                  <th><i class="bi bi-arrow-left-right me-1"></i>移動経路</th>
                  <th><i class="bi bi-box me-1"></i>商品</th>
                  <th class="text-end"><i class="bi bi-hash me-1"></i>数量</th>
                  <th class="text-end">操作</th>
                </tr>
              </thead>
              <tbody>
                <% @related_transfers.each do |related| %>
                  <tr>
                    <td><%= l(related.requested_at, format: :short) %></td>
                    <td>
                      <span class="badge bg-<%= related.status == 'completed' ? 'success' : 
                                                 related.status == 'pending' ? 'warning' : 'secondary' %>">
                        <%= related.status_text %>
                      </span>
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="badge bg-outline-danger me-2"><%= truncate(related.source_store.name, length: 8) %></span>
                        <i class="bi bi-arrow-right me-2"></i>
                        <span class="badge bg-outline-success"><%= truncate(related.destination_store.name, length: 8) %></span>
                      </div>
                    </td>
                    <td><%= truncate(related.inventory.name, length: 20) %></td>
                    <td class="text-end">
                      <span class="badge bg-secondary"><%= number_with_delimiter(related.quantity) %></span>
                    </td>
                    <td class="text-end">
                      <%= link_to admin_inter_store_transfer_path(related), 
                          class: "btn btn-outline-primary btn-sm" do %>
                        <i class="bi bi-eye"></i>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<%# TODO: 🟡 Phase 3（重要）- 管理者移動詳細機能の完全実装 %>
<%# 優先度: 中（管理機能完成度向上） %>
<%# 実装内容: %>
<%#   - ✅ 左→右UIレイアウト（店舗側と統一完了） %>
<%#   - ✅ タイムライン表示機能（完了） %>
<%#   - ✅ 在庫レベル予測機能（完了） %>
<%#   - ✅ 管理者操作パネル統合（完了） %>
<%#   - ⏳ 承認ワークフロー自動化 %>
<%#   - ⏳ 移動効率分析・レポート機能 %>
<%#   - ⏳ 一括承認・複数店舗間移動管理 %>
<%#   - ⏳ 異常パターン検知・アラート %>
<%# 横展開完了: StoreControllers::TransfersController#show との統一 %>
<%# メタ認知: 管理者視点の意思決定支援と業務効率化 %>
<%# 期待効果: 承認作業効率70%向上、意思決定品質向上 %>

<%# 却下理由入力モーダル %>
<div class="modal fade" id="rejectModal" tabindex="-1" aria-labelledby="rejectModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <%= form_with url: reject_admin_inter_store_transfer_path(@transfer), method: :patch, local: true do |f| %>
        <div class="modal-header">
          <h5 class="modal-title" id="rejectModalLabel">移動申請の却下</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>移動申請「<strong><%= @transfer.transfer_summary %></strong>」を却下しますか？</p>
          
          <div class="mb-3">
            <%= f.label :rejection_reason, "却下理由", class: "form-label" %>
            <%= f.text_area :rejection_reason, class: "form-control", rows: 3, 
                placeholder: "却下理由を入力してください（必須）", required: true %>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
          <%= f.submit "却下", class: "btn btn-danger" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<%# キャンセル理由入力モーダル %>
<div class="modal fade" id="cancelModal" tabindex="-1" aria-labelledby="cancelModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <%= form_with url: cancel_admin_inter_store_transfer_path(@transfer), method: :patch, local: true do |f| %>
        <div class="modal-header">
          <h5 class="modal-title" id="cancelModalLabel">移動申請のキャンセル</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>移動申請「<strong><%= @transfer.transfer_summary %></strong>」をキャンセルしますか？</p>
          
          <div class="mb-3">
            <%= f.label :cancellation_reason, "キャンセル理由", class: "form-label" %>
            <%= f.text_area :cancellation_reason, class: "form-control", rows: 3, 
                placeholder: "キャンセル理由を入力してください（任意）" %>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          <%= f.submit "キャンセル", class: "btn btn-warning" %>
        </div>
      <% end %>
    </div>
  </div>
</div>