<%# Single Action Button Component for Admin Interface %>
<%# This partial is used by _action_buttons.html.erb %>

<% 
  # Extract button configuration
  button_config = local_assigns[:button] || {}
  size = local_assigns[:size] || 'sm'
  
  # Button properties
  text = button_config[:text] || 'Action'
  path = button_config[:path]
  method = button_config[:method]
  icon = button_config[:icon]
  css_class = button_config[:class] || 'btn-secondary'
  confirm_message = button_config[:confirm]
  tooltip = button_config[:tooltip]
  disabled = button_config[:disabled] || false
  
  # Size suffix for button classes
  size_suffix = size == 'md' ? '' : "-#{size}"
  
  # Full button class
  full_class = "btn #{css_class} btn#{size_suffix}"
  full_class += " disabled" if disabled
  
  # Button attributes
  button_attrs = {}
  button_attrs[:title] = tooltip if tooltip.present?
  button_attrs[:disabled] = true if disabled
%>

<% if path.present? && !disabled %>
  <% if method == :delete %>
    <%# Delete buttons use button_to for proper HTTP method handling %>
    <%= button_to path, 
                 method: method,
                 class: full_class,
                 form: { 
                   data: { 
                     turbo_confirm: confirm_message,
                     turbo_method: method
                   } 
                 },
                 **button_attrs do %>
      <% if icon.present? %>
        <i class="bi <%= icon %> me-1" aria-hidden="true"></i>
      <% end %>
      <%= text %>
    <% end %>
  <% else %>
    <%# Regular links use link_to %>
    <%= link_to path, 
               class: full_class,
               method: method,
               data: (confirm_message.present? ? { confirm: confirm_message } : {}),
               **button_attrs do %>
      <% if icon.present? %>
        <i class="bi <%= icon %> me-1" aria-hidden="true"></i>
      <% end %>
      <%= text %>
    <% end %>
  <% end %>
<% else %>
  <%# Disabled or missing path - render as disabled button %>
  <button type="button" 
          class="<%= full_class %> disabled" 
          disabled
          <%= "title=\"#{tooltip}\"".html_safe if tooltip.present? %>>
    <% if icon.present? %>
      <i class="bi <%= icon %> me-1" aria-hidden="true"></i>
    <% end %>
    <%= text %>
  </button>
<% end %>